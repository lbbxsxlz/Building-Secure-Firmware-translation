## 第十六章

# 内核

固件的实现类似于嵌入式操作系统。它有一个内核来管理资源，例如系统内存，内核还负责分派任务。操作系统可以通过两种方式抵御软件攻击——破解漏洞和遏制破坏。与编译器防御技术类似，操作系统可以通过强制代码保护来破解漏洞，例如数据执行预防（DEP）、代码完整性防护（CIG）和任意代码防护（ACG）。地址空间布局随机化（ALSR）可使攻击者更难预测目标地址。如今，控制流防护（CFG）变得越来越重要，因为基于控制流的攻击可以绕过基本加固措施，如DEP。

如果内核无法破解漏洞利用，内核应将破坏控制在有限的范围内，并预防任何持续性破坏。权限隔离是遏制破坏的一种策略。在适当的硬件支持下，我们可以使用基于环的用户模式/监管模式隔离和基于虚拟机监控器（VMM）的隔离。加密域技术包括英特尔软件防护扩展（SGX）、AMD安全加密虚拟化（SEV）和英特尔信任域扩展（TDX）。域隔离也是另一种策略。可信执行环境（TEE）是另一个不错的选择，例如ARM TrustZone 技术和英特尔系统管理模式（SMM）。如果硬件支持域分区，一个平台可以独立运行两个或多个系统。表16-1列出了内核防御技术总结。

