## 第十二章

# 安全模型

在上一章中，我们介绍了不同的安全架构和设计，以实现一系列安全目标。在设计和架构讨论结束时，我们可能会有几个问题。具体来说，我如何知道设计是否足够好？是否有任何现有的框架或方案可以帮助我验证安全设计是否有效？对于这些问题，安全模型可以提供帮助。安全模型是一种用于描述系统的方法，也是一套满足安全要求的安全策略。例如，对第三方PCI选项ROM —— 系统固件不能信任它。我们需要验证PCI选项ROM，并授予PCI选项ROM的执行权。我们发现Clark-Wilson完整性模型可以应用于这一安全策略。该模型为不同的安全属性定义了九条规则，例如完整性、访问控制、审计和责任、审计和责任。利用这个模型，我们可以设计出一个安全的解决方案，并采用这些规则来提供必要的安全属性。

今天，我们有许多计算机安全模型。每个安全模型都是基于特定的安全策略在特定环境中开发和使用的。在本章中，我们将介绍一些安全模型，并将它们应用于固件安全特性。

## 机密性

机密性是信息技术中的一个重要安全属性。例如，在多级安全（MLS）系统中，信息可以处于不同的级别：绝密、机密、秘密和非机密。我们如何确保信息保持在正确的级别，并且不会流向安全级别较低的地方？

### 贝尔-拉帕杜拉（Bell-LaPadula）

在1970年代，大卫·艾略特·贝尔（David Elliott Bell）和伦纳德·J·拉帕杜拉（Leonard J. LaPadula）正式化了美国国防部（DoD）的多级安全（MLS）政策，并开发了贝尔-拉帕杜拉（Bell-LaPadula）模型。

在贝尔-拉帕杜拉模型中，主体和客体与安全级别或敏感级别相关联，例如绝密、机密、秘密和非机密。主体的最高安全级别称为许可级别。客体的安全级别称为数据分类级别。主体可以查看客体（读取）或更改客体（写入）。贝尔-拉帕杜拉模型中定义的主要规则如下：

    1）简单安全属性：在许可级别中的主体不能读取更高分类级别的客体。这被称为“不可向上读取”（NRU）。见图12-1，左侧。
    2）*（星）安全属性：在许可级别中的主体不能写入更低分类级别的客体。这被称为“不可向下写入”（NWD）。见图12-1，右侧。
       强制安全属性意味着对客体具有读写访问权限的主体只能在相同的安全级别上执行这两个功能。
    3）任意安全属性：主体可以基于访问控制矩阵访问客体。
    4）平静原则：主体不能改变客体的安全级别。这个规则出现在第一个贝尔-拉帕杜拉模型中，但后来被移除。在实际环境中，客体的安全级别控制因系统而异。
    
<div align=center><img src=Figures/Chapter-12-Screenshot/Figure-12-1.jpg></img></div>
<div align=center>图 12-1 贝尔-拉帕杜拉模型</div>

贝尔-拉帕杜拉模型可防止数据从高安全级别流向低安全级别，但它只关注机密性。该模型不考虑数据的完整性。例如，星形属性不允许向下写，但允许向上写，这意味着客体的完整性可能会被篡改。我们将在下一节讨论完整性模型中的这一部分。

这些特性可以更正式地表达出来。我们从初步的术语开始：

允许: 
$ subjects \space x \space access \space x \space objects \rightarrow boolean $

控制: 
$ labels \space x \space labels \space \rightarrow boolean $

其中无向上读取和无向下写入如下：

<!-- NRU: &forall;s &in; subjects, o &in; objects -->
$ NRU：\forall s \in subjects, o \in objects $

当且仅当符号（s）控制符号（o）允许（s,o,read）

和

<!-- NWD: &forall;s &in; subjects, o &in; objects -->
$ NWD: \forall s \in subjects, o \in objects $

当且仅当符号（s）控制符号（o）允许（s,o,write）

其中

labels = levels x P(categories)

示例可以包括

    levels = {confidential, secret}
    categories = {user, owner}
    P(categories) = {NULL, {user}, {owner}, {users, owner}}

和

    labels =
    {(confidential, {user}), (secret, {user}), (confidential, {owner}),
    (secret, {owner}), (confidential, (user, owner)},
    (secret, {users, owner}), (confidential, NULL), (secret, NULL)}

## 完整性

完整性是固件最重要的安全属性。NIST SP800-193提供了固件弹性准则，以维护固件的完整性。NIST SP800-155提供了完整性测量和认证指南。现在让我们来看看如何将完整性模型应用于它们。

### 毕巴(Biba)模型

1975年，Kenneth J.Biba提出了毕巴完整性模型，描述了一套确保数据完整性的访问控制策略和规则。

在毕巴模型中，主体和客体都与完整性级别相关联。对于主体来说，它由允许的完整性级别范围决定，以保持访问对象所需的最低完整性级别。对于对象来说，它意味着数据的重要性，例如关键、非常重要和重要。主体可以观察对象（读取）或修改对象（写入）。毕巴模型定义的主要规则如下：

    1）简单的完整性属性：完整性级别中的主体不能读取较低完整性级别的对象。这就是所谓的“不可向下读取”。见图12-2左侧。
    2）*（星）完整性属性：完整性级别的主体不能写入较高完整性级别的对象。这就是所谓的 “不可向上写入”。见图12-2右侧。
    3）调用属性：主体不能调用更高完整性级别中的主体。

<div align=center><img src=Figures/Chapter-12-Screenshot/Figure-12-2.jpg></img></div>
<div align=center>图 12-2 毕巴模型</div>

毕巴模型可防止数据从高完整性级别流向低完整性级别，但它只关注完整性。它不考虑机密性。在某些层面上，毕巴模型与贝尔-拉帕杜拉模型相反。对于简单安全属性，贝尔-拉帕杜拉模型不需要向上读取，而毕巴模型不需要向下读取。在星形安全属性中，贝尔-拉帕杜拉模型不需要向下写入，而毕巴模型不需要向上读取。

安全模型提供了一个框架指导你如何思考安全属性。特定的安全模型可能有其局限性。它可能是不必要的，因为某些规则可能过于严格或与其他规则相冲突。它可能不够充分，因为它没有涵盖某些实际用例。例如，如果一个现代商业系统同时需要机密性和完整性以及策略控制，那么它就需要同时应用毕巴模型和贝尔-拉帕杜拉模型。假设安全级别与完整性级别一致，那么规则就变成了只读等价和只写等价。隔离可能是实现这一目标的最佳方法。

### 克拉克-威尔逊模型

1987年，戴维-D-克拉克和戴维-R-威尔逊制定了克拉克-威尔逊商业策略，与前面列出的军事安全政策形成对比。它主要针对数据完整性问题的商业安全策略。克拉克-威尔逊模型包括以下概念：

    1）数据项
        A）受约束的数据项（CDI）
        B）不受约束的数据项（UDI）
    2）过程
        A）完整性验证过程（IVP）
        B）变换过程（TPs）
    3）规则：
        A）认证规则（CR）：完整性监控
           C1 —— （基础：IVP认证）：所有IVP必须正确确保所有CDI都处于有效状态。
           C2 —— （基础：有效性）：所有TP必须经过认证才有效。对于每个TP及其可能操纵的每组CDI，安全管理人员必须指定一种形式的“关系”（TP，{CDI}）。
           C3 —— （职责分离证明）：E2中的关系人名单必须经过认证，以满足分离职责要求。
           C4 —— （日志认证）：所有TP都必须通过认证，才能写入仅有附录的CDI（日志），所有信息需要自然操作许可才能重建。
           C5 —— （变换认证）：任何将UDI作为输入值的TP都必须经过认证，以便对UDI的任何可能值只执行有效的变换或不执行变换。转换应将输入值从UDI变换为CDI，否则UDI将被拒绝。
        B）执行规则（ER）：完整性保持
           E1 —— （基本：执行有效性）：系统必须维护C2中指定的关系列表，并确保只有经认证可在CDI上运行的TP才能操作该CDI。
           E2 —— （职责分离的执行）：系统必须将一个用户与每个TP和一组CDI关联起来，关系列表的形式为（user、TP、{CDI}）。系统必须确保只执行其中一种关系中描述的执行。
           E3 —— （用户身份）：系统必须认证每个试图执行TP的用户的身份。
           E4 —— （启动）：只有经认证实体许可的代理才能更改与其他实体相关的实体列表，特别是与TP相关的实体列表。可对实体进行认证的代理可能没有任何与该实体相关的执行权。

图12-3显示了克拉克-威尔逊模型中的认证规则和执行规则。

<div align=center><img src=Figures/Chapter-12-Screenshot/Figure-12-3.jpg></img></div>
<div align=center>图 12-3 克拉克-威尔逊模型</div>
