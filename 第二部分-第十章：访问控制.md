## 第十章

# 访问控制

访问控制是一种重要的安全机制，用于控制主体如何访问对象。这里的主体通常指最终用户，但也可以是计算机或运行中的进程。对象是指计算机系统或服务。对象可以是硬件，如网络或存储设备。对象也可以是软件，如操作系统或数据库。最后，对象可以是数据，如文件、注册表项或内存内容。典型的访问是指读取、写入或执行。访问分类还包括其他操作，如修改、创建、删除、追加、扩展等。访问控制可以保护系统和资源免遭未经授权的使用。在固件领域也是如此。

图10-1显示了BIOS中潜在的主体和对象集。例如，用户需要输入用户密码才能继续启动，或输入管理员密码才能进入设置用户界面（UI）页面。用户需要输入WIFI密码才能在BIOS中启用无线网络。平台BIOS会将固件组件测量值延伸到平台配置寄存器（PCR），以便Microsoft BitLocker从可信平台模块（TPM）设备中解封磁盘加密密钥。只有在正确的PCR值延伸到TPM后，平台才能访问存储设备。只有创建TEE的早期固件才能访问可信执行环境（TEE）。这种早期启动的开放访问有时被称为时间隔离。一旦构建了TEE，非TEE代码就不能再访问TEE环境。

<div align=center><img src=Figures/Chapter-9-Screenshot/Figure-10-1.jpg></img></div>
<div align=center>图 10-1 固件中的主题与对象</div>

对于对象来说，三大安全原则是CIA —— 机密性、完整性和可用性。对于此次主题，我们需要考虑的是IAA —— 识别、认证和授权。识别是主体声称拥有特定身份的手段。例如，用户拥有用户名、电子邮件地址或手机号码作为身份。认证是系统用来验证主体身份的过程。三种典型的身份验证手段包括：(1) 使用主体知道的东西，例如密码；(2) 使用主体拥有的东西，如智能卡；(3) 使用主体本身，例如指纹。身份识别和认证信息构成了主体的凭证。凭证会与该主体的预存凭证进行比较。如果两者匹配，则主体通过认证。

当主体通过认证后，系统需要确定主体可以访问哪些对象资源。这可以是预定义的访问矩阵，也可以是对象的安全标签。如果系统确定主体可以访问对象，就会对主体进行授权。

固件中的识别、认证和授权可以简化。例如，如果系统只支持一个用户，则可以跳过用户识别，只需进行认证。授权也可以很简单，只需继续启动即可。

在接下来的章节中，我们将从对象的角度逐一讨论访问控制功能。

## 启动访问控制

